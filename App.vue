<template><divclass="onlineGallery-container"ref="container":data-open="appInfo.container.open":style="{'--width':appInfo.window.width * appInfo.container.widthPercentage * 0.01 + 'px',}"><Body /><el-buttonclass="onlineGallery-button-close"type="danger"circle@click="openSwitch"><template #icon><el-icon><i-ep-Close /></el-icon></template></el-button><el-popoverplacement="top-start"title="快捷菜单":width="'auto'"trigger="hover":disabled="appInfo.container.open"><template #reference><el-buttontype="primary"size="default"@click="openSwitch"class="onlineGallery-button-drawerOpen"><template #icon><el-icon><i-ep-ArrowRightBold style="pointer-events: none"/></el-icon></template></el-button></template><template #default><el-button type="success" size="small" @click="openSwitch"><template #icon><el-icon><i-ep-Grid /></el-icon></template><el-badge :value="cardsStore.data.cardList.length" :max="999">图库</el-badge></el-button><el-buttontype="primary"size="small"@click="ruleEditor.container.open = true"><template #icon><el-icon><i-ep-Management /></el-icon></template>规则管理</el-button><el-button type="primary" size="small" @click=""><template #icon><el-icon><i-ep-Tools /></el-icon></template>设置</el-button></template></el-popover></div><div class="onlineGallery-child-window-container"><RuleEditor /></div></template><script setup lang="ts">const appInfo = useAppInfoStore(); const cardsStore = useCardsStore(); const toolBar = useToolBarStore(); const ruleEditor = useRuleEditorStore(); const container = ref(); const openSwitch = async () => {appInfo.container.open = !appInfo.container.open;if (appInfo.container.open) {document.documentElement.dataset.showScrollbar = false.toString(); container.value.focus();} else {document.documentElement.dataset.showScrollbar = true.toString(); }};onMounted(async () => {await ruleEditor.getLocationRule(); toolBar.selectingInitRule(); ElNotification({title: "提示",message: h("i", {style: "color: teal"}, "onlineGallery 已加载"),duration: 3000,});if (appInfo.container.open) {document.documentElement.dataset.showScrollbar = "false"; container.value.focus();} else {document.documentElement.dataset.showScrollbar = "true"; }});</script><style scoped lang="scss">* {box-sizing: border-box;border: 0;pointer-events: auto;}$z-index: 2147483646;.onlineGallery-container {box-sizing: border-box;position: fixed;z-index: $z-index;padding: 0 30px 20px 30px;margin: 0;left: calc(0px - var(--width));top: 0 !important;bottom: 0;width: var(--width);max-width: 100vw !important;background-color: rgba(255, 255, 255, 0.8);box-shadow: var(--el-box-shadow-dark);backdrop-filter: blur(2px);display: flex;flex-flow: column;justify-content: start;align-items: center;transition: 0.5s ease;&[data-open="true"] {left: 0px !important;}&:focus {outline: none;}@media (max-width: 500px) {padding: 4px;}}.onlineGallery-button-drawerOpen {position: absolute;z-index: 1;margin: auto 0;$size: 30px;width: $size - 0px;height: $size * 2;border-radius: 0 $size $size 0;right: 0;top: 0;bottom: 0;cursor: pointer;display: flex;justify-content: center;align-items: center;font-size: xx-large;:root:has(.onlineGallery-container[data-open="false"]) & {border-radius: 0 $size $size 0 !important;box-shadow: var(--el-box-shadow-light);right: -$size;transition: 0.25s 0.25s ease;}:root:has(.onlineGallery-container[data-open="true"]) & {border-radius: $size 0 0 $size !important;background-color: transparent;box-shadow: none;transition: 0.25s 0.25s ease;}& i {transition: 0.25s 0.25s ease;:root:has(.onlineGallery-container[data-open="false"]) & {transform: rotateY(0deg);color: auto;}:root:has(.onlineGallery-container[data-open="true"]) & {transform: rotateY(180deg);color: #409eff;}}@media (max-width: 500px) {& {right: -$size !important;i {transform: rotateY(0deg) !important;}}}}.onlineGallery-button-close {position: absolute;right: 10px;top: 10px;width: fit-content;height: fit-content;box-shadow: var(--el-box-shadow-light);}.onlineGallery-child-window-container {position: fixed;z-index: $z-index;overflow: visible;}</style>