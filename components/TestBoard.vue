<template> <DragModal v-model="openModal" :modal-init-width="400" :modal-init-height="400" modal-class="modal" teleport=".onlineGallery-child-window-container" > <template #title> 测试窗口 </template> <template #default> <div>当前使用内存使用情况:</div> <div v-if="isSupported && memory" class="inline-grid grid-cols-2 gap-x-4 gap-y-2" > <template v-if="memory"> <div opacity="50">使用中: {{ size(memory.usedJSHeapSize) }}</div> <div opacity="50">已分配: {{ size(memory.totalJSHeapSize) }}</div> <div opacity="50">最大值: {{ size(memory.jsHeapSizeLimit) }}</div> </template> </div> <div>可见卡片数量: {{ cardsStore.visibleCards.length }}</div> <div> <div>剪切板支持情况：{{ clipboard_isSupported }}</div> <div>剪切板内容：{{ clipboard_text }}</div> </div> </template> <template #footer> <div class="test-footer"> <var-button type="primary" @click="handleClose" > <span style="color: rgb(256, 256, 256) !important"> 确认 </span> </var-button> <var-button type="primary" @click="get_ClipBoardText" > 获取剪切板文本 </var-button> <var-button @click="handleClose">取 消</var-button> </div> </template> </DragModal></template><script setup lang="ts"> interface IProps { modelValue: boolean; } const props = withDefaults(defineProps<IProps>(), { modelValue: false, }); const emits = defineEmits(["update:modelValue"]); const {text, isSupported: clipboard_isSupported, copy, copied} = useClipboard(); const openModal = ref(false); onMounted(() => { openModal.value = props.modelValue; }); watch( () => props.modelValue, (newVal) => { openModal.value = newVal; } ); function handleClose() { openModal.value = false; emits("update:modelValue", false); } const clipboard_text = ref(""); async function get_ClipBoardText() { clipboard_text.value = await getClipBoardText(); } const appInfo = useAppInfoStore(); const cardsStore = useCardsStore(); const eagleStore = useEagleStore(); const eagle = eagleStore.eagle; const containerRef = ref<HTMLElement | null>(); const {isSupported, memory} = useMemory(); function size(v: number) { const kb = v / 1024 / 1024; return `${kb.toFixed(2)} MB`; } const init = reactive({ left: 0, top: 0, }); const style = computed(() => { return { left: init.left + "px", top: init.top + "px", }; });</script><style lang="scss" scoped> .modal { background-color: transparent; } .test-footer { padding-top: 4px; width: 100%; height: fit-content; display: flex; flex-flow: row nowrap; justify-content: end; gap: 4px; }</style>