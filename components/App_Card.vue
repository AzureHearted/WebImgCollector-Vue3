<template> <div class="onlineGallery-card" @contextmenu.prevent.self @click="clickHandle"> <AppImg class="onlineGallery-card-content" :src="card.url"></AppImg> <div class="tag-group"> <el-tag class="tag-width-and-height" round size="small" type="info" @click.right.prevent="copyTagContent(`${card.width}x${card.height}`)" >{{ card.width }}x{{ card.height }} </el-tag> <el-tag class="tag-width-and-height" round size="small" @click.right.prevent="copyTagContent(card.name)" > {{ card.name }} </el-tag> </div> <el-checkbox v-model="card.selected" class="onlineGallery-card-checkbox" size="default" /> <el-button class="onlineGallery-card-button-download" type="primary" size="small" circle :icon="Download" @click.stop="download" :loading="downloading" ></el-button> </div></template><script setup>import AppImg from "./App_Img.vue";import { getBlobByUrl } from "../js/public.js";import { Download } from "@element-plus/icons-vue"; const { text, isSupported, copy } = useClipboard();const props = defineProps({ card: { type: Object, default() { return { name: "", url: "", originUrls: [], width: 0, height: 0, aspectRatio: 3 / 4, selected: false, dom: null, }; }, },});let downloading = ref(false); const copyTagContent = async (content) => { await copy(content); ElMessage({ type: "success", grouping: true, center: true, duration: 1000, offset: 80, message: h("p", { style: "display:flex;gap:10px" }, [ h("i", { style: "color: teal" }, content), h("span", { style: "color: black" }, "复制成功！"), ]), });};const clickHandle = async (e) => { return;};const download = async () => { downloading.value = true; if (props.card.blob != null) { await saveAs(props.card.blob, props.card.name); downloading.value = false; } else { const url = props.card.url; let blob = await getBlobByUrl(url, "Fetch"); if (!blob) { blob = await getBlobByUrl(url, "GM"); } if (!blob) { blob = await getBlobByUrl(url, "GM", location.origin); } if (blob) { await saveAs(blob, props.card.name); downloading.value = false; } else { downloading.value = false; } }};</script><style scoped lang="scss">* { border: 0; margin: 0; box-sizing: border-box; user-select: none; -webkit-user-drag: none;}.onlineGallery-card { border: 0 !important; margin: 0 !important; padding: 0 !important; scroll-snap-align: start; position: relative; border-radius: 4px; box-shadow: var(--el-box-shadow-dark); aspect-ratio: var(--aspect-ratio); max-width: 100%; max-height: var(--cardMaxHeight); width: calc(var(--cardMaxHeight) * var(--aspect-ratio)) !important; background-color: transparent; overflow: hidden; cursor: pointer; transition: 0.5s; &:hover { box-shadow: 1px 2px 12px 6px rgba(0, 0, 0, 0.5); } .onlineGallery-card-content { border: 0 !important; margin: 0 !important; padding: 0 !important; width: 100%; height: auto; object-position: center; -webkit-user-drag: none; background-position: center; background-repeat: repeat; background-size: contain; } .onlineGallery-card-button-download { position: absolute; top: 1px; right: 1px; font-size: small; box-shadow: var(--el-box-shadow-light); } .onlineGallery-card-checkbox { position: absolute !important; height: fit-content; top: 4px !important; left: 4px !important; box-shadow: var(--el-box-shadow-light); } .tag-group { position: absolute; width: 100%; bottom: 4px; left: 4px; display: flex; flex-flow: row wrap; gap: 2px; * { box-shadow: var(--el-box-shadow-light); } }}</style>