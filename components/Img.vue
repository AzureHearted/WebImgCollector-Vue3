<template><img :parentSelector="parentSelector" v-lazy.src="src" v-if="lazy" /><img :src="src" v-else /></template><script lang="ts" setup>interface IProps {parentSelector?: string;src: string;lazy: boolean;lazyMargin?: string;}const props = withDefaults(defineProps<IProps>(), {src: "",parentSelector: "body",lazy: false,lazyMargin(props) {return "0%";},});const vLazy = {mounted(el, binding, vNode) {el.dataset.show = false; let url = binding.value; let observer = new IntersectionObserver((entries, observer) => {entries.forEach((entire) => {if (entire.isIntersecting) {observer.unobserve(el); el.src = url; if (el.tagName == "IMG") {if (el.complete) {el.dataset.show = true;} else {el.addEventListener("load", fn);el.addEventListener("error", fn);function fn() {el.dataset.show = true;el.removeEventListener("load", fn);el.removeEventListener("error", fn);}}} else {el.dataset.show = true;}}});},{root: document.querySelector(props.parentSelector),rootMargin: props.lazyMargin,}); observer.observe(el);},};</script><style lang="scss" scoped>* {margin: 0 !important;padding: 0 !important;border: 0 !important;box-sizing: border-box !important;z-index: 0 !important;}[data-show="true"] {opacity: 1;filter: blur(0px);transition: 0.2s;}[data-show="false"] {opacity: 0;filter: blur(10px);transition: 0.2s;}</style>